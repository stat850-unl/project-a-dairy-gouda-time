---
title: "USMap"
author: "Kassidy Buse"
date: "11/17/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

First, we need to pull in the data set that includes the milk production for each state and region
```{r}
urlfile <- "https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-01-29/state_milk_production.csv"
dairycsv <- read.csv(urlfile)
dairybystate <- as.data.frame(dairycsv)
```

explore a little
```{r}
range(dairybystate$milk_produced)
```

Smallest value is     3,000,000
Largest value is 42,339,000,000
Yikes that is a large range. 
```{r}
which.min(dairybystate$milk_produced)
which.max(dairybystate$milk_produced)
```

Wonder who they are (let's be honest...the low is either AK or HI)
```{r}
dairybystate[2199,]
```
Like I said, AK or HI. I'm betting the high is CA...because happy cows are in CA...or just very hot ones
```{r}
dairybystate[2248,]
```

Of course it is CA...and 2014 was a great year for dairy so that isn't surprising at all.
Filter said data for future use
```{r}
library(tidyverse)
dairy70 <- dairybystate %>% filter(year == 1970)
dairy80 <- dairybystate %>% filter(year == 1980)
dairy90 <- dairybystate %>% filter(year == 1990)
dairy00 <- dairybystate %>% filter(year == 2000)
dairy10 <- dairybystate %>% filter(year == 2010)
dairy17 <- dairybystate %>% filter(year == 2017)
```

```{r}
range(dairy70$milk_produced)

```
```{r}
range(dairy80$milk_produced)
```

## Where Kassidy's eyes were bigger than her plate: 

### Making a freaking cool map

1970
```{r}
library(usmap)
library(ggplot2)

plot_usmap(regions = "states", data = dairy70, values = "milk_produced", color = "black") + 
  scale_fill_continuous(type = "viridis", name = "Production, lb", label = scales::comma, breaks = c(10000000000, 20000000000, 30000000000, 40000000000), limits = c(0, 45000000000)) +
  labs(title = "Dairy Production in the United States",
       subtitle = "Changes in dairy produciton by state from in 1970") + 
  theme(panel.background = element_rect(color = "black", fill = "white"), legend.position = "right")
```

1980
```{r}
library(usmap)
library(ggplot2)

plot_usmap(regions = "states", data = dairy80, values = "milk_produced", color = "black") + 
  scale_fill_continuous(type = "viridis", name = "Production, lb", label = scales::comma, breaks = c(5000000000, 10000000000, 15000000000, 20000000000, 25000000000, 30000000000, 35000000000, 40000000000), limits = c(0, 45000000000)) +
  labs(title = "Dairy Production in the United States",
       subtitle = "Changes in dairy produciton by state in 1980") + 
  theme(panel.background = element_rect(color = "black", fill = "white"), legend.position = "right")
```

1990
```{r}
library(usmap)
library(ggplot2)

plot_usmap(regions = "states", data = dairy90, values = "milk_produced", color = "black") + 
  scale_fill_continuous(type = "viridis", name = "Production, lb", label = scales::comma, breaks = c(5000000000, 10000000000, 15000000000, 20000000000, 25000000000, 30000000000, 35000000000, 40000000000), limits = c(0, 45000000000)) +
  labs(title = "Dairy Production in the United States",
       subtitle = "Changes in dairy produciton by state in 1990") + 
  theme(panel.background = element_rect(color = "black", fill = "white"), legend.position = "right")
```

2000
```{r}
library(usmap)
library(ggplot2)

plot_usmap(regions = "states", data = dairy70, values = "milk_produced", color = "black") + 
  scale_fill_continuous(type = "viridis", name = "Production, lb", label = scales::comma, breaks = c(5000000000, 10000000000, 15000000000, 20000000000, 25000000000, 30000000000, 35000000000, 40000000000), limits = c(0, 45000000000)) +
  labs(title = "Dairy Production in the United States",
       subtitle = "Changes in dairy produciton by state in 2000") + 
  theme(panel.background = element_rect(color = "black", fill = "white"), legend.position = "right")
```

2010
```{r}
library(usmap)
library(ggplot2)

plot_usmap(regions = "states", data = dairy70, values = "milk_produced", color = "black") + 
  scale_fill_continuous(type = "viridis", name = "Production, lb", label = scales::comma, breaks = c(5000000000, 10000000000, 15000000000, 20000000000, 25000000000, 30000000000, 35000000000, 40000000000), limits = c(0, 45000000000)) +
  labs(title = "Dairy Production in the United States",
       subtitle = "Changes in dairy produciton by state in 2010") + 
  theme(panel.background = element_rect(color = "black", fill = "white"), legend.position = "right")
```

2017
```{r}
library(usmap)
library(ggplot2)

plot_usmap(regions = "states", data = dairy70, values = "milk_produced", color = "black") + 
  scale_fill_continuous(type = "viridis", name = "Production, lb", label = scales::comma, breaks = c(5000000000, 10000000000, 15000000000, 20000000000, 25000000000, 30000000000, 35000000000, 40000000000), limits = c(0, 45000000000)) +
  labs(title = "Dairy Production in the United States",
       subtitle = "Changes in dairy produciton by state in 2017") + 
  theme(panel.background = element_rect(color = "black", fill = "white"), legend.position = "right")
```
