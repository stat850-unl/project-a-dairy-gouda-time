---
title: "USMap"
author: "Kassidy Buse"
date: "11/17/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

First, we need to pull in the data set that includes the milk production for each state and region
```{r}
urlfile <- "https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-01-29/state_milk_production.csv"
dairycsv <- read.csv(urlfile)
dairybystate <- as.data.frame(dairycsv)
```

explore a little
```{r}
range(dairybystate$milk_produced)
```

Smallest value is     3,000,000
Largest value is 42,339,000,000
Yikes that is a large range. 
```{r}
which.min(dairybystate$milk_produced)
which.max(dairybystate$milk_produced)
```

Wonder who they are (let's be honest...the low is either AK or HI)
```{r}
dairybystate[2199,]
```
Like I said, AK or HI. I'm betting the high is CA...because happy cows are in CA...or just very hot ones
```{r}
dairybystate[2248,]
```

Of course it is CA...and 2014 was a great year for dairy so that isn't surprising at all.

I obviously can't plot every year, and with a range this large, the continuous fill scale would be so broad that it wouldn't accurately depict the data. So, we have to break this down. 

Filtering the data down to some "key" years for map making. 
```{r}
library(tidyverse)
dairy70 <- dairybystate %>% filter(year == 1970)
dairy80 <- dairybystate %>% filter(year == 1980)
dairy90 <- dairybystate %>% filter(year == 1990)
dairy00 <- dairybystate %>% filter(year == 2000)
dairy10 <- dairybystate %>% filter(year == 2010)
dairy17 <- dairybystate %>% filter(year == 2017)
```

Now to find the ranges of these years. 
```{r}
range(dairy70$milk_produced)
```
```{r}
range(dairy80$milk_produced)
```

```{r}
range(dairy90$milk_produced)
```

```{r}
range(dairy00$milk_produced)
```

```{r}
range(dairy10$milk_produced)
```

```{r}
range(dairy17$milk_produced)
```

So it looks like our minimum value is 3,000,000 and our maximum value is 40,385,000,000. 
Well, that didn't help much, but logically, we can eliminate the lower bounds because we aren't interested in these small states with limited supply, we want the milk. 

After "playing" with the data a bit, I decided on a range of 2,500,000,000 to 30,000,000,000. I left the lower limit at 2,500,000,000 to bring in more states. The year 2010 is what was really throwing the upper limit off. Adjusting the upper limit from 20,000,000,000 to 50,000,000,000 didn't result in any changes in teh states displayed or the colors displayed, so 30,000,000,000 seemed like a decent limit. 

## Where Kassidy's eyes were bigger than her plate: 

### Making a freaking cool map

1970
```{r}
library(usmap)
library(ggplot2)

usa70 <- plot_usmap(regions = "states", data = dairy70, values = "milk_produced", color = "black") + 
  scale_fill_continuous(type = "viridis", name = "Production, lb", label = scales::comma, breaks = c(10000000000, 20000000000, 30000000000, 40000000000), limits = c(2500000000, 30000000000)) +
  labs(title = "Dairy Production in the United States",
       subtitle = "Changes in dairy produciton by state from in 1970") + 
  theme(panel.background = element_rect(color = "black", fill = "white"), legend.position = "right")

usa70
```

1980
```{r}
library(usmap)
library(ggplot2)

usa80 <- plot_usmap(regions = "states", data = dairy80, values = "milk_produced", color = "black") + 
  scale_fill_continuous(type = "viridis", name = "Production, lb", label = scales::comma, breaks = c(10000000000, 20000000000, 30000000000, 40000000000), limits = c(2500000000, 30000000000)) +
  labs(title = "Dairy Production in the United States",
       subtitle = "Changes in dairy produciton by state in 1980") + 
  theme(panel.background = element_rect(color = "black", fill = "white"), legend.position = "right")

usa80
```

1990
```{r}
library(usmap)
library(ggplot2)

usa90 <- plot_usmap(regions = "states", data = dairy90, values = "milk_produced", color = "black") + 
  scale_fill_continuous(type = "viridis", name = "Production, lb", label = scales::comma, breaks = c(10000000000, 20000000000, 30000000000, 40000000000), limits = c(2500000000, 30000000000)) +
  labs(title = "Dairy Production in the United States",
       subtitle = "Changes in dairy produciton by state in 1990") + 
  theme(panel.background = element_rect(color = "black", fill = "white"), legend.position = "right")

usa90
```

2000
```{r}
library(usmap)
library(ggplot2)

usa00 <- plot_usmap(regions = "states", data = dairy70, values = "milk_produced", color = "black") + 
  scale_fill_continuous(type = "viridis", name = "Production, lb", label = scales::comma, breaks = c(10000000000, 20000000000, 30000000000, 40000000000), limits = c(2500000000, 30000000000)) +
  labs(title = "Dairy Production in the United States",
       subtitle = "Changes in dairy produciton by state in 2000") + 
  theme(panel.background = element_rect(color = "black", fill = "white"), legend.position = "right")

usa00
```

2010
```{r}
library(usmap)
library(ggplot2)

usa10 <- plot_usmap(regions = "states", data = dairy70, values = "milk_produced", color = "black") + 
  scale_fill_continuous(type = "viridis", name = "Production, lb", label = scales::comma, breaks = c(10000000000, 20000000000, 30000000000, 40000000000), limits = c(2500000000, 30000000000)) +
  labs(title = "Dairy Production in the United States",
       subtitle = "Changes in dairy produciton by state in 2010") + 
  theme(panel.background = element_rect(color = "black", fill = "white"), legend.position = "right")

usa10
```

2017
```{r}
library(usmap)
library(ggplot2)

usa17 <- plot_usmap(regions = "states", data = dairy70, values = "milk_produced", color = "black") + 
  scale_fill_continuous(type = "viridis", name = "Production, lb", label = scales::comma, breaks = c(10000000000, 20000000000, 30000000000, 40000000000), limits = c(2500000000, 30000000000)) +
  labs(title = "Dairy Production in the United States",
       subtitle = "Changes in dairy produciton by state in 2017") + 
  theme(panel.background = element_rect(color = "black", fill = "white"), legend.position = "right")

usa17
```

let's try and animate this...because that would just be cool

Here we have the whole data set...no select years like above()
```{r}
library(usmap)
library(ggplot2)

usa <- plot_usmap(regions = "states", data = dairybystate, values = "milk_produced", color = "black") + 
  scale_fill_continuous(type = "viridis", name = "Production, lb", label = scales::comma, breaks = c(10000000000, 20000000000, 30000000000, 40000000000), limits = c(2500000000, 30000000000)) +
  labs(title = "Dairy Production in the United States",
       subtitle = "Changes in dairy produciton by state in 2017") + 
  theme(panel.background = element_rect(color = "black", fill = "white"), legend.position = "right")

usa
```

```{r}
library(gganimate)
theme_set(theme_bw())
library(gapminder)

usa + transition_time(year) +
  labs(title = "Year")
```

